{% extends "layouts/base.html" %}

{% block content %}
<div class="container mt-4">
    <h2 class="fw-bold mb-4">Analytics Dashboard</h2>

    <div class="row">

        <div class="col-md-4">
            <div class="card text-center shadow-sm p-3">
                <h4>Total Patients</h4>
                <h2 class="text-primary">{{ total }}</h2>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card text-center shadow-sm p-3">
                <h4>Average Age</h4>
                <h2 class="text-success">{{ avg_age | round(1) }}</h2>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card text-center shadow-sm p-3">
                <h4>Hypertension Cases</h4>
                <h2 class="text-danger">{{ hypertension }}</h2>
            </div>
        </div>

    </div>

    <div class="row mt-4">

        <div class="col-md-6">
            <canvas id="genderChart"></canvas>
        </div>

        <div class="col-md-6">
            <canvas id="riskChart"></canvas>
        </div>

    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
const genderChart = new Chart(
    document.getElementById('genderChart'),
    {
        type: 'pie',
        data: {
            labels: {{ gender_counts.keys() | list | safe }},
            datasets: [{
                data: {{ gender_counts.values() | list | safe }},
                backgroundColor: ["#007bff", "#dc3545", "#ffc107"]
            }]
        }
    }
);

const riskChart = new Chart(
    document.getElementById('riskChart'),
    {
        type: 'bar',
        data: {
            labels: ["Hypertension", "Heart Disease"],
            datasets: [{
                data: [{{ hypertension }}, {{ heart_disease }}],
                backgroundColor: ["#dc3545", "#6f42c1"]
            }]
        }
    }
);
</script>

{% endblock %}
